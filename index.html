<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial="initial-scale=1.0">
    <title>ğŸ³ ëƒ‰ì¥ê³  íŒŒë¨¹ê¸° íƒ€ì´ì¿¤ (Pixel Art)</title>

    <style>
        /* ğŸ”‘ ë‹¨ê³„ 1: Galmuri11.ttf íŒŒì¼ ë¡œë“œ */
        @font-face {
            font-family: 'Galmuri11';
            src: url('Galmuri11.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        /* 1. í”½ì…€ ì•„íŠ¸ ìŠ¤íƒ€ì¼ì˜ ê¸°ë³¸ ì„¤ì • */
        
        :root {
            --pixel-font: 'Galmuri11', sans-serif; /* ğŸ”‘ í°íŠ¸ ì´ë¦„ ë³€ê²½ */
            --main-color: #4CAF50; 
            --sub-color: #FFC107;
            --border-color: #333333;
            --box-shadow-color: #1a1a1a;
            --padding-unit: 8px;
        }

        body {
            /* ğŸ”‘ í°íŠ¸ ì ìš© */
            font-family: var(--pixel-font);
            color: var(--border-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            /* í”½ì…€ í°íŠ¸ì˜ ê¹¨ë—í•œ ë Œë”ë§ì„ ìœ„í•´ ë‹¤ì‹œ ì ìš© */
            image-rendering: pixelated; 
            font-size: 0.8em; /* í”½ì…€ í°íŠ¸ì— ë§ì¶° í¬ê¸° ì¡°ì • */

            /* âœ¨ ë°°ê²½ ì´ë¯¸ì§€ ì ìš© âœ¨ */
            background-image: url('pixel_kitchen_background_wide_v2.png'); /* â¬…ï¸ ì´ë¯¸ì§€ íŒŒì¼ ì´ë¦„ */
            background-size: cover; /* í™”ë©´ì„ ê½‰ ì±„ìš°ë„ë¡ */
            background-position: center; /* ì´ë¯¸ì§€ë¥¼ ì¤‘ì•™ì— ë°°ì¹˜ */
            background-repeat: no-repeat; /* ì´ë¯¸ì§€ ë°˜ë³µ ë°©ì§€ */
            background-color: #555; /* ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ê¸° ì „ ë°°ê²½ìƒ‰ */
        }

        h1 {
            color: var(--main-color);
            font-size: 1.5em; /* í”½ì…€ í°íŠ¸ì— ë§ì¶° í¬ê¸° ì¡°ì • */
            margin-bottom: 20px;
            text-shadow: 2px 2px 0px var(--box-shadow-color);
        }

        /* 2. ì…ë ¥ í¼ ë° ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .input-group {
            margin-bottom: 15px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: var(--padding-unit);
            font-size: 1em;
        }

        input[type="text"], textarea {
            width: calc(100% - 16px);
            padding: var(--padding-unit);
            border: 2px solid var(--border-color);
            background-color: #fff;
            box-shadow: 2px 2px 0px var(--box-shadow-color);
            font-family: var(--pixel-font);
            font-size: 1em; /* í”½ì…€ í°íŠ¸ì— ë§ì¶° í¬ê¸° ì¡°ì • */
            resize: none;
        }

        textarea {
            height: 100px;
        }

        .btn-pixel {
            background-color: var(--sub-color);
            color: var(--border-color);
            border: 4px solid var(--border-color);
            padding: 10px 20px;
            font-family: var(--pixel-font);
            font-size: 1.2em; /* í”½ì…€ í°íŠ¸ì— ë§ì¶° í¬ê¸° ì¡°ì • */
            cursor: pointer;
            box-shadow: 4px 4px 0px var(--box-shadow-color);
            transition: all 0.1s;
        }

        .btn-pixel:hover {
            background-color: #ffe70f;
        }

        .btn-pixel:active {
            box-shadow: 0 0 0 var(--box-shadow-color);
            transform: translate(4px, 4px);
        }

        /* 3. ê²°ê³¼ ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .result-area {
            margin-top: 30px;
            padding: 15px;
            border: 2px dashed var(--main-color);
            background-color: #E8F5E9;
            min-height: 150px;
            text-align: left;
            font-family: var(--pixel-font);
            font-size: 1.1em; /* í”½ì…€ í°íŠ¸ì— ë§ì¶° í¬ê¸° ì¡°ì • */
            line-height: 1.6;
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 500px;
        }

        .result-area h2 {
            font-size: 1.3em;
            color: var(--main-color);
            margin-top: 0;
            margin-bottom: 10px;
        }

        /* ë¡œë”© ìŠ¤í”¼ë„ˆ (í”½ì…€ ì•„íŠ¸ ëŠë‚Œ) */
        .loading-spinner {
            display: none;
            text-align: center;
            margin: 20px 0;
            font-size: 1.5em;
            animation: blinker 1s step-start infinite;
            color: var(--main-color);
        }

        @keyframes blinker {
            50% { opacity: 0; }
        }

        /* âœ¨ ê²Œì„ ì»¨í…Œì´ë„ˆ ë°°ê²½ ë°˜íˆ¬ëª… ì„¤ì • âœ¨ */
        .game-container {
            width: 100%;
            max-width: 800px;
            background-color: rgba(255, 255, 255, 0.85); /* â¬…ï¸ ë°˜íˆ¬ëª… í°ìƒ‰ ë°°ê²½ */
            padding: 20px;
            border: 4px solid var(--border-color);
            box-shadow: 8px 8px 0px var(--box-shadow-color);
            text-align: center;
            position: relative;
            z-index: 1;
        }

    </style>
</head>
<body>

    <div class="game-container">
        <h1>âœ¨ ëƒ‰ì¥ê³ íŒŒë¨¹ê¸°ğŸ½ï¸âœ¨</h1>
        
        <div class="input-form">
            <div class="input-group">
                <label for="ingredients">ğŸŒ± ì‚¬ìš©ìì˜ ì¬ë£Œ (ì˜ˆ: ì–‘íŒŒ, ê°ì, ì†Œê³ ê¸° ì¡°ê¸ˆ):</label>
                <input type="text" id="ingredients" placeholder="ì¬ë£Œë“¤ì„ ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”." required>
            </div>
            
            <div class="input-group">
                <label for="flavor_preference">ğŸ˜‹ ì›í•˜ëŠ” ìš”ë¦¬ì˜ ë§› ë˜ëŠ” ì¢…ë¥˜ (ì˜ˆ: ì–¼í°í•œ êµ­ë¬¼ ìš”ë¦¬, ê°„ë‹¨í•œ ë³¶ìŒ, ë‹¬ì½¤í•œ ë””ì €íŠ¸):</label>
                <textarea id="flavor_preference" placeholder="ì–´ë–¤ ìš”ë¦¬ë¥¼ ë¨¹ê³  ì‹¶ì€ì§€ ê°„ë‹¨íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”." required></textarea>
            </div>
            
            <button class="btn-pixel" onclick="register()">ë ˆì‹œí”¼ ê²€ìƒ‰</button>
        </div>

        <div id="loading-spinner" class="loading-spinner">
            ìš”ë¦¬ ë ˆì‹œí”¼ë¥¼ ìƒê° ì¤‘...
        </div>

        <div class="result-area" id="recipe-result">
            <h2>ğŸ“ƒ ë ˆì‹œí”¼ ê²°ê³¼ì°½</h2>
            ì—¬ê¸°ì— LLMì´ ì¶”ì²œí•œ ìš”ë¦¬ ì´ë¦„ê³¼ ìƒì„¸ ë ˆì‹œí”¼ê°€ ì°¨ê·¼ì°¨ê·¼ í‘œì‹œë©ë‹ˆë‹¤.
        </div>
    </div>

    <script>
        // API ì„œë²„ì˜ ì£¼ì†Œë¥¼ ë‹´ëŠ” ìƒìˆ˜ ì •ì˜ 
        const SERVER_URL = ""; 

        /**
         * 'ë ˆì‹œí”¼ ê²€ìƒ‰' ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
         * ì…ë ¥ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ì—¬ ì„œë²„ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.
         */
        async function register() {
            const ingredients = document.getElementById('ingredients').value.trim();
            const flavorPreference = document.getElementById('flavor_preference').value.trim();
            const resultArea = document.getElementById('recipe-result');
            const loadingSpinner = document.getElementById('loading-spinner');

            if (!ingredients || !flavorPreference) {
                alert("ì¬ë£Œì™€ ì›í•˜ëŠ” ë§›/ì¢…ë¥˜ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }

            // 1. ë¡œë”© ìƒíƒœ í‘œì‹œ
            loadingSpinner.style.display = 'block';
            resultArea.innerHTML = `<h2>ìš”ë¦¬ì‚¬ AIê°€ ë ˆì‹œí”¼ë¥¼ êµ¬ìƒ ì¤‘ì…ë‹ˆë‹¤...</h2>`;
            
            // 2. ì„œë²„ì— ì „ì†¡í•  ë°ì´í„° (JSON) êµ¬ì„±
            const requestData = {
                user_ingredients: ingredients,
                flavor_preference: flavorPreference
            };

            console.log("ì„œë²„ë¡œ ì „ì†¡í•  ë°ì´í„°:", requestData);

            // 3. fetch í•¨ìˆ˜ë¥¼ ì´ìš©í•œ API í†µì‹  (POST ë°©ì‹)
            try {
                // **ì£¼ì˜:** í˜„ì¬ SERVER_URLì´ ë¹„ì–´ ìˆìœ¼ë¯€ë¡œ, ì´ ë¶€ë¶„ì€ ì‹¤í–‰ë˜ì§€ ì•Šê³  ë°”ë¡œ catch ë¸”ë¡ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
                const response = await fetch(SERVER_URL, {
                    method: 'POST', // í†µì‹  ë°©ì‹: POST
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData) 
                });

                if (!response.ok) {
                    throw new Error(`HTTP ì˜¤ë¥˜! ìƒíƒœ ì½”ë“œ: ${response.status}`);
                }

                const data = await response.json();
                
                // 4. ì„±ê³µ ì‹œ ê²°ê³¼ ì˜ì—­ ì—…ë°ì´íŠ¸
                displayRecipe(data);

            } catch (error) {
                console.error("API í†µì‹  ì˜¤ë¥˜ ë°œìƒ:", error);
                
                // 5. ì˜¤ë¥˜ ë˜ëŠ” í˜„ì¬ mock ë°ì´í„°ë¡œ ê²°ê³¼ ì˜ì—­ ì—…ë°ì´íŠ¸
                const mockRecipe = {
                    dish_name: "âœ¨ ì–‘ê° ì†Œì‹œì§€ ì§œê¸€ì´ (Mock Recipe) âœ¨",
                    ingredients_needed: "ì–‘íŒŒ, ê°ì, ì†Œê³ ê¸° ì™¸: ê³ ì¶”ì¥ 2T, ë‹¤ì§„ ë§ˆëŠ˜ 1T, ë¬¼ 300ml, ëŒ€íŒŒ 1/2ëŒ€",
                    steps: [
                        "1. ì–‘íŒŒì™€ ê°ìë¥¼ ë¨¹ê¸° ì¢‹ì€ í¬ê¸°ë¡œ ì°ê³ , ì†Œê³ ê¸°ëŠ” í•´ë™í•´ ì£¼ì„¸ìš”.",
                        "2. ëƒ„ë¹„ì— ë¬¼ê³¼ ê³ ì¶”ì¥, ë‹¤ì§„ ë§ˆëŠ˜ì„ ë„£ê³  ë“ì…ë‹ˆë‹¤. (ì–¼í°í•œ êµ­ë¬¼ ë§›!)",
                        "3. ë¬¼ì´ ë“ìœ¼ë©´ ê°ìë¥¼ ë¨¼ì € ë„£ê³  5ë¶„ê°„ ë“ì—¬ì£¼ì„¸ìš”.",
                        "4. ì–‘íŒŒì™€ ì†Œê³ ê¸°ë¥¼ ë„£ê³  ê³ ê¸°ê°€ ìµì„ ë•Œê¹Œì§€ ì¤‘ë¶ˆì—ì„œ ë“ì…ë‹ˆë‹¤.",
                        "5. ë§ˆì§€ë§‰ì— ëŒ€íŒŒë¥¼ ë„£ê³  í•œì†Œë” ë” ë“ì—¬ì£¼ë©´, ë”°ëˆí•œ ì§œê¸€ì´ ì™„ì„±!"
                    ].join('\n'),
                    ai_comment: "ë‚¨ì€ ì¬ë£Œë¡œ ë“ ë“ í•œ í•œ ë¼ë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ”, í•œêµ­ì¸ì˜ ì†Œìš¸í‘¸ë“œ ì§œê¸€ì´ë¥¼ ì¶”ì²œí–ˆì–´ìš”!"
                };

                displayRecipe(mockRecipe);

            } finally {
                // 6. ë¡œë”© ìƒíƒœ í•´ì œ
                loadingSpinner.style.display = 'none';
            }
        }

        /**
         * ë ˆì‹œí”¼ ê°ì²´ë¥¼ ë°›ì•„ ê²°ê³¼ ì˜ì—­ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
         */
        function displayRecipe(recipe) {
            const resultArea = document.getElementById('recipe-result');

            resultArea.innerHTML = `
                <h2>â­ ${recipe.dish_name} â­</h2>
                
                <p><strong>ğŸ’¡ AIì˜ ì½”ë©˜íŠ¸:</strong> ${recipe.ai_comment || 'ë§›ìˆê²Œ ë“œì„¸ìš”!'}</p>

                <br>
                <strong>[í•„ìš”í•œ ì¶”ê°€ ì¬ë£Œ]</strong>
                <p>${recipe.ingredients_needed}</p>
                
                <br>
                <strong>[ìš”ë¦¬ ê³¼ì • (STEP BY STEP)]</strong>
                <p>${recipe.steps}</p>
                <br>
                <p style="text-align: center; color: var(--sub-color);">âœ¨ Bon AppÃ©tit! âœ¨</p>
            `;
        }
    </script>
</body>
</html>