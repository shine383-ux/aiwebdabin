<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ³ ëƒ‰ì¥ê³  íŒŒë¨¹ê¸° íƒ€ì´ì¿¤ (Pixel Art)</title>

    <style>
        /* 1. í°íŠ¸ ì„¤ì • */
        @font-face {
            font-family: 'Galmuri11';
            src: local('Galmuri11'), url('Galmuri11.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        /* 2. ê¸°ë³¸ ë³€ìˆ˜ */
        :root {
            --pixel-font: 'Galmuri11', sans-serif;
            --main-color: #4CAF50; 
            --sub-color: #FFC107;
            --border-color: #333333;
            --box-shadow-color: #1a1a1a;
            --padding-unit: 8px;
            
            /* ë©”ëª¨ì¥ ì¤„ë¬´ëŠ¬ ìƒ‰ìƒ (ì•„ì£¼ ì—°í•œ í•˜ëŠ˜ìƒ‰) */
            --ruled-line-color: #D0E8F2; 
            
            /* ğŸ”‘ í•µì‹¬ ìˆ˜ì •: í…Œë‘ë¦¬ë¥¼ ìœ„í•œ ì„ ëª…í•œ íŒŒë€ìƒ‰ ë³€ìˆ˜ ì¶”ê°€ */
            --blue-border-color: #2196F3;

            --ruled-line-height: 1.6em; 
        }

        body {
            font-family: var(--pixel-font);
            color: var(--border-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            image-rendering: pixelated; 
            font-size: 0.8em;

            /* ë°°ê²½ ì´ë¯¸ì§€ ì„¤ì • */
            background-image: url('pixel_kitchen_background_wide_v2.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed; /* ë°°ê²½ ê³ ì • */
            background-color: #555;
        }

        h1 {
            color: var(--main-color);
            font-size: 1.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 0px var(--box-shadow-color);
        }

        /* 3. ê²Œì„ ì»¨í…Œì´ë„ˆ (ë°˜íˆ¬ëª… íš¨ê³¼) */
        .game-container {
            width: 100%;
            max-width: 800px;
            background-color: rgba(255, 255, 255, 0.85); 
            padding: 20px;
            border: 4px solid var(--border-color);
            box-shadow: 8px 8px 0px var(--box-shadow-color);
            text-align: center;
            position: relative;
            z-index: 1;
        }

        /* 4. ì…ë ¥ í¼ ìŠ¤íƒ€ì¼ */
        .input-group {
            margin-bottom: 15px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: var(--padding-unit);
            font-size: 1em;
        }

        input[type="text"], textarea {
            width: calc(100% - 16px);
            padding: var(--padding-unit);
            border: 2px solid var(--border-color);
            background-color: #fff;
            box-shadow: 2px 2px 0px var(--box-shadow-color);
            font-family: var(--pixel-font);
            font-size: 1em;
            resize: none;
        }

        textarea {
            height: 100px;
        }

        .btn-pixel {
            background-color: var(--sub-color);
            color: var(--border-color);
            border: 4px solid var(--border-color);
            padding: 10px 20px;
            font-family: var(--pixel-font);
            font-size: 1.2em;
            cursor: pointer;
            box-shadow: 4px 4px 0px var(--box-shadow-color);
            transition: all 0.1s;
        }

        .btn-pixel:hover {
            background-color: #ffe70f;
        }

        .btn-pixel:active {
            box-shadow: 0 0 0 var(--box-shadow-color);
            transform: translate(4px, 4px);
        }

        /* 5. ê²°ê³¼ ì˜ì—­ (ë©”ëª¨ì¥ ëŠë‚Œ + íŒŒë€ í…Œë‘ë¦¬) */
        .result-area {
            margin-top: 30px;
            padding: 15px;
            
            /* ë©”ëª¨ì¥ ì¤„ë¬´ëŠ¬ ë°°ê²½ */
            background-color: #FFFFFF; 
            background-image: 
                repeating-linear-gradient(
                    to bottom, 
                    transparent, 
                    transparent calc(var(--ruled-line-height) - 1px), 
                    var(--ruled-line-color) calc(var(--ruled-line-height) - 1px), 
                    var(--ruled-line-color) var(--ruled-line-height)
                );
            background-size: 100% var(--ruled-line-height);

            /* ğŸ”‘ í•µì‹¬ ìˆ˜ì •: í…Œë‘ë¦¬ ìƒ‰ìƒì„ íŒŒë€ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
            border: 2px dashed var(--blue-border-color); 
            
            min-height: 150px;
            text-align: left;
            font-family: var(--pixel-font);
            font-size: 1.1em;
            line-height: 1.6;
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 500px;
        }

        .result-area h2 {
            font-size: 1.3em;
            color: var(--main-color);
            margin-top: 0;
            margin-bottom: 10px;
        }

        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading-spinner {
            display: none;
            text-align: center;
            margin: 20px 0;
            font-size: 1.5em;
            animation: blinker 1s step-start infinite;
            color: var(--main-color);
        }

        @keyframes blinker {
            50% { opacity: 0; }
        }
    </style>
</head>
<body>

    <div class="game-container">
        <h1>âœ¨ ëƒ‰ì¥ê³ íŒŒë¨¹ê¸°ğŸ½ï¸âœ¨</h1>
        
        <div class="input-form">
            <div class="input-group">
                <label for="ingredients">ğŸŒ± ì‚¬ìš©ìì˜ ì¬ë£Œ (ì˜ˆ: ì–‘íŒŒ, ê°ì, ì†Œê³ ê¸° ì¡°ê¸ˆ):</label>
                <input type="text" id="ingredients" placeholder="ì¬ë£Œë“¤ì„ ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”." required>
            </div>
            
            <div class="input-group">
                <label for="seasonings">ğŸ§‚ ì‚¬ìš©ìì˜ ì–‘ë… (ì˜ˆ: ê°„ì¥, ê³ ì¶”ì¥, ì°¸ê¸°ë¦„):</label>
                <input type="text" id="seasonings" placeholder="ë³´ìœ í•œ ì–‘ë…ì„ ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”.">
            </div>
            
            <div class="input-group">
                <label for="flavor_preference">ğŸ˜‹ ì›í•˜ëŠ” ìš”ë¦¬ì˜ ë§› ë˜ëŠ” ì¢…ë¥˜ (ì˜ˆ: ì–¼í°í•œ êµ­ë¬¼ ìš”ë¦¬, ê°„ë‹¨í•œ ë³¶ìŒ, ë‹¬ì½¤í•œ ë””ì €íŠ¸):</label>
                <textarea id="flavor_preference" placeholder="ì–´ë–¤ ìš”ë¦¬ë¥¼ ë¨¹ê³  ì‹¶ì€ì§€ ê°„ë‹¨íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”." required></textarea>
            </div>
            
            <button class="btn-pixel" onclick="register()">ë ˆì‹œí”¼ ê²€ìƒ‰</button>
        </div>

        <div id="loading-spinner" class="loading-spinner">
            ìš”ë¦¬ ë ˆì‹œí”¼ë¥¼ ìƒê° ì¤‘...
        </div>

        <div class="result-area" id="recipe-result">
            <h2>ğŸ“ƒ ë ˆì‹œí”¼ ê²°ê³¼ì°½</h2>
            ì—¬ê¸°ì— LLMì´ ì¶”ì²œí•œ ìš”ë¦¬ ì´ë¦„ê³¼ ìƒì„¸ ë ˆì‹œí”¼ê°€ ì°¨ê·¼ì°¨ê·¼ í‘œì‹œë©ë‹ˆë‹¤.
        </div>
    </div>

    <script>
        // API ì„œë²„ ì£¼ì†Œ
        const SERVER_URL = ""; 

        async function register() {
            const ingredients = document.getElementById('ingredients').value.trim();
            const seasonings = document.getElementById('seasonings').value.trim(); // ì–‘ë… ê°’
            const flavorPreference = document.getElementById('flavor_preference').value.trim();
            const resultArea = document.getElementById('recipe-result');
            const loadingSpinner = document.getElementById('loading-spinner');

            if (!ingredients || !flavorPreference) {
                alert("ì¬ë£Œì™€ ì›í•˜ëŠ” ë§›/ì¢…ë¥˜ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }

            // ë¡œë”© ì‹œì‘
            loadingSpinner.style.display = 'block';
            resultArea.innerHTML = `<h2>ìš”ë¦¬ì‚¬ AIê°€ ë ˆì‹œí”¼ë¥¼ êµ¬ìƒ ì¤‘ì…ë‹ˆë‹¤...</h2>`;
            
            const requestData = {
                user_ingredients: ingredients,
                user_seasonings: seasonings,
                flavor_preference: flavorPreference
            };

            console.log("ì„œë²„ë¡œ ì „ì†¡í•  ë°ì´í„°:", requestData);

            try {
                const response = await fetch(SERVER_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestData) 
                });

                if (!response.ok) throw new Error(`HTTP ì˜¤ë¥˜! ìƒíƒœ ì½”ë“œ: ${response.status}`);
                const data = await response.json();
                displayRecipe(data);

            } catch (error) {
                console.error("API í†µì‹  ì˜¤ë¥˜ ë°œìƒ (Mock Data ì‚¬ìš©):", error);
                
                // ê°€ì§œ ë°ì´í„°(Mock Data) í‘œì‹œ
                const mockRecipe = {
                    dish_name: "âœ¨ ì–‘ê° ì†Œì‹œì§€ ì§œê¸€ì´ (Mock Recipe) âœ¨",
                    ingredients_needed: "ì–‘íŒŒ, ê°ì, ì†Œê³ ê¸° ì™¸: ê³ ì¶”ì¥ 2T, ë‹¤ì§„ ë§ˆëŠ˜ 1T, ë¬¼ 300ml, ëŒ€íŒŒ 1/2ëŒ€",
                    steps: [
                        "1. ì–‘íŒŒì™€ ê°ìë¥¼ ë¨¹ê¸° ì¢‹ì€ í¬ê¸°ë¡œ ì°ê³ , ì†Œê³ ê¸°ëŠ” í•´ë™í•´ ì£¼ì„¸ìš”.",
                        "2. ëƒ„ë¹„ì— ë¬¼ê³¼ ê³ ì¶”ì¥, ë‹¤ì§„ ë§ˆëŠ˜ì„ ë„£ê³  ë“ì…ë‹ˆë‹¤. (ì–¼í°í•œ êµ­ë¬¼ ë§›!)",
                        "3. ë¬¼ì´ ë“ìœ¼ë©´ ê°ìë¥¼ ë¨¼ì € ë„£ê³  5ë¶„ê°„ ë“ì—¬ì£¼ì„¸ìš”.",
                        "4. ì–‘íŒŒì™€ ì†Œê³ ê¸°ë¥¼ ë„£ê³  ê³ ê¸°ê°€ ìµì„ ë•Œê¹Œì§€ ì¤‘ë¶ˆì—ì„œ ë“ì…ë‹ˆë‹¤.",
                        "5. ë§ˆì§€ë§‰ì— ëŒ€íŒŒë¥¼ ë„£ê³  í•œì†Œë” ë” ë“ì—¬ì£¼ë©´, ë”°ëˆí•œ ì§œê¸€ì´ ì™„ì„±!"
                    ].join('\n'),
                    ai_comment: `ë‚¨ì€ ì¬ë£Œì™€ ë³´ìœ  ì–‘ë…(${seasonings || 'ì—†ìŒ'})ì„ í™œìš©í•œ ë“ ë“ í•œ ìš”ë¦¬ë¥¼ ì¶”ì²œí–ˆì–´ìš”!`
                };
                displayRecipe(mockRecipe);

            } finally {
                loadingSpinner.style.display = 'none';
            }
        }

        function displayRecipe(recipe) {
            const resultArea = document.getElementById('recipe-result');
            resultArea.innerHTML = `
                <h2>â­ ${recipe.dish_name} â­</h2>
                <p><strong>ğŸ’¡ AIì˜ ì½”ë©˜íŠ¸:</strong> ${recipe.ai_comment || 'ë§›ìˆê²Œ ë“œì„¸ìš”!'}</p>
                <br>
                <strong>[í•„ìš”í•œ ì¶”ê°€ ì¬ë£Œ]</strong>
                <p>${recipe.ingredients_needed}</p>
                <br>
                <strong>[ìš”ë¦¬ ê³¼ì • (STEP BY STEP)]</strong>
                <p>${recipe.steps}</p>
                <br>
                <p style="text-align: center; color: var(--sub-color);">âœ¨ Bon AppÃ©tit! âœ¨</p>
            `;
        }
    </script>
</body>
</html>